<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title><%= picObj.name %></title>
	<link rel="stylesheet" href="css/pic4ward.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.4/raphael-min.js"></script>
	<script type="text/javascript" language="JavaScript">
		function set_body_height()
		{
		    var wh = $(window).height();
		    $('div').attr('style', 'height:' + wh + 'px;');
		}
		
		function setup_canvas() {
			//var coordinates = [];
			//var pair = {};
			var path = "M ";
			var calculated;
			var oldX = 0;
			var oldY = 0;
			var temp;

			<% for (var i = 0; i < clickables[0].points.length; i++){ %>
			<% if (i != 0) { %>
				path += 'l ';
			<% } %>
			calculated = $("img").width() * <%= clickables[0].points[i].x %>;
			temp = Math.round(calculated);
			calculated = temp - oldX;
			oldX = temp;
			path += calculated + ' ';
			calculated = $("img").height() * <%= clickables[0].points[i].y %>;
			temp = Math.round(calculated);
			calculated = temp - oldY;
			oldY = temp;
			path += calculated + ' ';
			<% } %>

			path += "z"

			console.log(path);

			var clickable = "M 250 250 l 0 -50 l -50 0 l 0 -50 l -50 0 l 0 50 l -50 0 l 0 50 z";
    		this.paper = new Raphael( (($(window).width()/2)-($("img").width())/2), 0, $("img").width(), $("img").height());
    		this.circle = this.paper.path(path);
    		var that = this;
    		var shimmer = function () {
    			that.circle.animate({stroke: '#FFFFFF'}, 250, shammer);
			}
			var shammer = function () {
    			that.circle.animate({stroke: '#000000'}, 750, shimmer);
			}
			shimmer();
    	}
    	$(document).ready(function() {
    		set_body_height();
    		$(window).bind('resize', function() { 
		    	this.circle.hide();
		    	set_body_height(); 
		    	setup_canvas();
		    });
    	});
		$(window).load(function() {			
		    setup_canvas();	    
		});
	</script>
</head>
<body>
	<div>
		<img src="<%= picObj.url %>" alt="The first" class="center fit"></img>
	</div>
</body>
</html>